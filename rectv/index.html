<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INADINA TV - Sistem Oynatıcısı</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/mpegts.js/dist/mpegts.js"></script>
    <style>
        :root { --primary: #ff0040; --bg: #0f0a1a; --surface: #1a1825; }
        body { background: var(--bg); color: #fff; font-family: sans-serif; margin: 0; overflow-x: hidden; }
        .top-bar { padding: 15px 20px; background: var(--surface); display: flex; justify-content: space-between; align-items: center; position: sticky; top:0; z-index:100; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .logo { font-size: 1.4rem; font-weight: 800; color: var(--primary); }
        
        /* KATEGORİ CHIPS (spor.html'den) */
        .cat-scroll { display: flex; gap: 10px; overflow-x: auto; padding: 15px; scrollbar-width: none; }
        .chip { background: var(--surface); padding: 8px 18px; border-radius: 20px; white-space: nowrap; cursor: pointer; border: 1px solid #333; font-size: 0.85rem; }
        .chip.active { background: var(--primary); border-color: var(--primary); }

        .container { padding: 10px 15px; }
        .card { background: rgba(255,255,255,0.06); border-radius: 12px; padding: 10px; margin-bottom: 10px; display: flex; align-items: center; cursor: pointer; border: 1px solid rgba(255,255,255,0.05); }
        .img-box { position: relative; width: 50px; height: 50px; flex-shrink: 0; }
        .card-img { width: 100%; height: 100%; border-radius: 8px; object-fit: cover; }
        .badge-yeni { position: absolute; top: -5px; right: -5px; background: #ffab00; color: #000; font-size: 0.55rem; padding: 2px 4px; border-radius: 4px; font-weight: bold; }
        .card-info { flex: 1; margin-left: 12px; overflow: hidden; }
        .card-name { font-weight: bold; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* SİSTEM OYNATICISI (Gelişmiş) */
        #playerView { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 2000; }
        video { width: 100%; height: 100%; }
        .p-tools { position: absolute; bottom: 0; width: 100%; padding: 20px; background: linear-gradient(transparent, rgba(0,0,0,0.8)); display: flex; justify-content: space-around; }
        .close-btn { position: absolute; top: 20px; right: 20px; font-size: 1.8rem; z-index: 2100; cursor: pointer; }

        /* MODAL */
        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:1500; display:none; justify-content:center; align-items:center; }
        .modal-box { background: var(--surface); width: 85%; max-width: 380px; border-radius: 20px; padding: 20px; }
        .opt { display: flex; align-items: center; padding: 12px; margin: 8px 0; border-radius: 12px; background: rgba(255,255,255,0.05); cursor: pointer; gap: 15px; }
    </style>
</head>
<body>
    <div class="top-bar"><div class="logo">INADINA TV</div><a href="https://t.me/inadinatv" style="color:white;"><i class="fab fa-telegram"></i></a></div>
    
    <!-- Kategori Çipleri -->
    <div class="cat-scroll" id="catList"></div>

    <div class="container" id="channelList">
        <p style="text-align:center; opacity:0.5;">Liste yükleniyor, lütfen bekleyin...</p>
    </div>

    <!-- Oynatıcı Ekranı -->
    <div id="playerView">
        <i class="fas fa-times close-btn" onclick="closePlayer()"></i>
        <video id="video" controls playsinline></video>
    </div>

    <!-- Seçenekler Modal -->
    <div class="modal" id="modal">
        <div class="modal-box">
            <h3 id="mTitle" style="text-align:center; margin-top:0;"></h3>
            <div class="opt" onclick="startPlay('system')"><i class="fas fa-play-circle" style="color:var(--primary)"></i> <div><b>Sistem Oynatıcısı</b><br><small>Tarayıcıda izle</small></div></div>
            <div class="opt" onclick="startPlay('wuffy')"><i class="fas fa-external-link-alt" style="color:#2ecc71"></i> <div><b>Wuffy Player</b><br><small>Dış Uygulama</small></div></div>
            <div class="opt" onclick="startPlay('xpola')"><i class="fas fa-rocket" style="color:#3498db"></i> <div><b>Xpola Player</b><br><small>Dış Uygulama</small></div></div>
            <div class="opt" onclick="openLink()"><i class="fas fa-download"></i> <div><b>İndirme Linki</b><br><small>Web Sayfası</small></div></div>
            <button onclick="closeModal()" style="width:100%; padding:10px; margin-top:10px; background:none; border:1px solid #444; color:white; border-radius:10px;">Kapat</button>
        </div>
    </div>

    <script>
        
        const manualItems = [{"title": "HİYPER İPTV", "url": "https://deathless.short.gy/Hibrit-iptv.m3u", "image": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS4yG_juMJsuYS1fMI3WD6l6yqJTAo80TL3k6NqS2G63PIwAxwarsjUuTE&s=10", "web_link_url": "http://bc.vc/350724/https%3A%2F%2Fpastequest.com%2F%3F90c121487ac97817%23ABygvp9wZ3hXZYD55ih4tKAF3z6WuUwp3DJVWHBHg6z", "added_date": "22.12.2025", "is_new": true}, {"title": "Spor iptv link", "url": "https://izleyici.aykara463.workers.dev/DeaTHLesS.m3u", "image": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS4yG_juMJsuYS1fMI3WD6l6yqJTAo80TL3k6NqS2G63PIwAxwarsjUuTE&s=10", "web_link_url": "http://bc.vc/350724/https%3A%2F%2Fpastequest.com%2F%3F9e5647dfc5121267%23GeupXSf1dX1ALr9q7QkQ3wMfHk6QKxkPt3FcGhYRwBKZ", "added_date": "22.12.2025", "is_new": false}, {"title": "2450 X iptv", "url": "http://190502.tomtv.eu/get.php?username=mehmetkilic7578&password=trx68502602&type=m3u_plus", "image": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS4yG_juMJsuYS1fMI3WD6l6yqJTAo80TL3k6NqS2G63PIwAxwarsjUuTE&s=10", "web_link_url": "http://bc.vc/350724/https%3A%2F%2Fpastequest.com%2F%3F2464417c73d9c36d%2314D5aXAatfgVpVY4N5L9jvpdeBxevRyQSuCbcGkHa78A", "added_date": "22.12.2025", "is_new": false}, {"title": "Yeni İptv link", "url": "https://file.garden/Z-hq5n4Shk27aY58/Goodplay-iptv.m3u", "image": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS4yG_juMJsuYS1fMI3WD6l6yqJTAo80TL3k6NqS2G63PIwAxwarsjUuTE&s=10", "web_link_url": "http://bc.vc/350724/https%3A%2F%2Fpastequest.com%2F%3Fd30a7708a51baa97%23gbmY8p2VSmESy1388tXXq8rfajMwEg26mmkU2MWXiQ4", "added_date": "22.12.2025", "is_new": false}];
        const remoteM3U = "https://file.garden/aMCMLdwOhlHjDvvq/inaduna-Goals.m3u";
        const proxyURL = "https://raw.githubusercontent.com/burhantasci72-png/tumsiteler/refs/heads/main/Canli_Spor_Hepsi.m3u";
        
        let allChannels = [];
        let currentItem = {};
        let hls;

        // 1. ADIM: Listeyi Yükle (M3U + Manuel)
        async function init() {
            try {
                // Manuel eklenenleri al
                allChannels = manualItems.map(i => ({...i, group: "Özel Listem"}));
                
                // M3U dosyasını spor.html mantığıyla çek
                const res = await fetch(`${proxyURL}?url=${encodeURIComponent(remoteM3U)}`);
                const text = await res.text();
                parseM3U(text);
                
                renderCategories();
                filterGroup("Özel Listem");
            } catch (e) {
                console.error("Yükleme hatası:", e);
                filterGroup("Özel Listem"); // Hata olsa da manuel olanları göster
            }
        }

        function parseM3U(data) {
            const lines = data.split('\n');
            let cur = null;
            lines.forEach(l => {
                if(l.startsWith('#EXTINF:')) {
                    const g = l.match(/group-title="([^"]+)"/);
                    const t = l.match(/,(.+)$/);
                    const img = l.match(/tvg-logo="([^"]+)"/);
                    cur = { 
                        title: t ? t[1].trim() : "Kanal", 
                        group: g ? g[1] : "Genel", 
                        image: img ? img[1] : "https://i.hizliresim.com/91rbev6.png",
                        is_new: false 
                    };
                } else if(l.trim() && !l.startsWith('#') && cur) {
                    cur.url = l.trim();
                    allChannels.push(cur);
                    cur = null;
                }
            });
        }

        // 2. ADIM: Kategorileri ve Kanalları Listele
        function renderCategories() {
            const groups = ["Özel Listem", ...new Set(allChannels.map(c => c.group))];
            const div = document.getElementById('catList');
            div.innerHTML = groups.map(g => `<div class="chip" onclick="filterGroup('${g}', this)">${g}</div>`).join('');
            if(div.firstChild) div.firstChild.classList.add('active');
        }

        function filterGroup(name, el) {
            if(el) {
                document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
                el.classList.add('active');
            }
            const list = document.getElementById('channelList');
            const filtered = allChannels.filter(c => c.group === name);
            list.innerHTML = filtered.map(c => `
                <div class="card" onclick="openModal('${b64EncodeUnicode(JSON.stringify(c))}')">
                    <div class="img-box">
                        <img src="${c.image}" class="card-img" onerror="this.src='https://i.hizliresim.com/91rbev6.png'">
                        ${c.is_new ? '<span class="badge-yeni">YENİ</span>' : ''}
                    </div>
                    <div class="card-info">
                        <div class="card-name">${c.title}</div>
                        <div style="font-size:0.7rem; opacity:0.4;">${c.group}</div>
                    </div>
                    <i class="fas fa-play-circle" style="color:var(--primary); font-size:1.3rem;"></i>
                </div>
            `).join('');
        }

        // 3. ADIM: Modal ve Oynatma Kontrolleri
        function openModal(data) {
            currentItem = JSON.parse(b64DecodeUnicode(data));
            document.getElementById('mTitle').innerText = currentItem.title;
            document.getElementById('modal').style.display = 'flex';
        }

        function startPlay(type) {
            closeModal();
            const url = currentItem.url;
            if(type === 'system') {
                document.getElementById('playerView').style.display = 'block';
                const video = document.getElementById('video');
                if(url.includes('.m3u8')) {
                    if(hls) hls.destroy();
                    hls = new Hls();
                    hls.loadSource(url);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
                } else {
                    video.src = url;
                    video.play();
                }
            } else {
                const s = type === 'wuffy' ? 'xmtv' : 'xmtv-m3u';
                window.location.href = `intent://${btoa(url)}#Intent;scheme=${s};package=com.${type}.player;end`;
            }
        }

        function closePlayer() {
            document.getElementById('playerView').style.display = 'none';
            const v = document.getElementById('video');
            v.pause();
            if(hls) hls.destroy();
        }

        function closeModal() { document.getElementById('modal').style.display = 'none'; }
        function openLink() { if(currentItem.web_link_url !== "#") window.open(currentItem.web_link_url, '_blank'); }

        // Unicode güvenli base64 (Türkçe karakterler için)
        function b64EncodeUnicode(str) { return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (match, p1) => String.fromCharCode('0x' + p1))); }
        function b64DecodeUnicode(str) { return decodeURIComponent(atob(str).split('').map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join('')); }

        init();
    </script>
</body>
</html>